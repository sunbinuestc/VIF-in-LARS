# 双光载荷图像融合及其在低空遥感中的应用
<a href="https://github.com/sunbinuestc/VIF-in-LARS/blob/main/README_eng_ver.md">English Version</a>
## 摘要
双光载荷图像融合在目标监测、灾情预警及专业巡检等低空遥感领域有着广泛的应用前景。首先针对应用场景，统计并归纳了任务载荷双光图像数据集，为相关研究及应用提供数据支持。其次，跟踪深度学习领域的最新技术，系统总结基于深度学习的双光载荷图像融合方法，将现有方法归纳为生成式和判别式两类，并详细梳理代表性的方法及特点。再次，从定性分析、融合质量及运行效率三个方面，对不同类型的图像融合方法在不同数据集上的融合效果进行深入的实验对比分析。最后，探讨图像融合技术在低空遥感应用中面临的挑战问题，为相关领域的研究提供参考。
## 低空遥感双光图像数据集
表1统计了以低空飞行器为平台，搭载双光载荷的各类应用场景数据集，包括但不限于目标监测、灾情预警、专业巡检等。其中所有数据集均包含可见光和灰度/伪彩色红外图像对或视频对，配准后的双光图像对可支持像素级图像融合方法的研究和验证。其中，图像类型1表示可见光和灰度红外图像，2表示可见光和伪彩色红外图像。

**目标监测**：低空飞行器在执行目标监测任务时，常常面临恶劣天气、光照变化等挑战性问题。红外与可见光图像融合可以为警务及管理人员提供可视化的融合结果，清晰呈现场景及重点目标信息，用于交通、安检等昼夜监测，提升监测系统的实用性和效率。

**灾情预警**：在应对各种灾情时，低空飞行器是不可或缺的遥感平台。尤其在火灾中由于烟雾密集导致视觉受限严重，结合可见光与红外图像融合技术，能够同步且清晰地呈现火点区域及其周边环境细节，为救援人员了解及研判火情提供重要依据。

**专业巡检**：低空飞行器搭载双光载荷，能够提供巡检目标空中视角的双光图像。结合图像融合技术为专业巡检人员提供巡检场景及关键热辐射区域的可视化效果，可以对高层建筑立面、屋顶及热桥等特定区域实施能源审计；对桥梁、路面、堤坝等基础设施进行无损检测；以及对电力线、绝缘子以及核设施等高危设备进行巡检，辅助专业人员发现安全隐患并定位故障，提升巡检效率。

<div align=center>表1 低空遥感双光图像数据集</div>
<table align=center>
  <tr>
    <th>应用场景</th>
    <th>数据集</th>
    <th>年份</th>
    <th>机构</th>
    <th>图像/视频对</th>
    <th>分辨率</th>
    <th>图像类型</th>
    <th>配准</th>
  </tr>
  <tr>
    <td rowspan="11">目标监测</td>
    <td><a href="https://zhang-pengyu.github.io/DUT-VTUAV/#Download">VTUAV</a></td>
    <td>2022</td>
    <td>大连理工大学</td>
    <td>500</td>
    <td>1920×1080</td>
    <td>1</td>
    <td>是</td>
  </tr>
  <tr>
    <td><a href="https://github.com/VisDrone/Drone-Vehicle">DroneVehicle</a></td>
    <td>2022</td>
    <td>天津大学</td>
    <td>28439</td>
    <td>640×512</td>
    <td>1</td>
    <td>是</td>
  </tr>
</table>

## 基于深度学习的图像融合方法分类
本文聚焦可见光和红外图像融合算法在低空遥感场景下的应用，依据网络架构和建模方式对深度学习方法进行分类，所采用的分类方式可以推广至其它类型的图像融合方法。随着深度学习在视觉任务中的突破性进展，以深度学习为基础的图像融合方法逐渐成为关注的热点。根据数据分布的不同建模方式，基于深度学习的图像融合方法可以分为判别式与生成式两大类。

判别式方法使用参数化的网络模型对条件概率分布进行建模，通过在特征间构建损失函数学习从多个输入到单个输出的映射关系，从而预测融合结果。这类方法训练过程直接且高效，适用于处理数据分布较为复杂的情况，但不具备生成新数据的能力。

生成式方法显式或隐式地学习数据的联合概率分布，通过在分布间构建损失函数建立输入和输出之间的关系生成新的融合结果。这类方法可以捕捉数据的分布规律具备生成能力，能够应对模态缺失的融合问题。但是计算过程较为复杂耗时。

<div align=center><img src="assets/1.png"></div>
<div align=center>图1 基于深度学习的图像融合方法分类</div>
<div align=center>表2 判别式深度学习图像融合方法对比</div>
<table align=center>
  <tr>
    <th>判别式融合</th>
    <th>特征表示</th>
    <th>融合策略</th>
    <th>监督方式</th>
    <th>训练方式</th>
    <th>复杂度</th>
    <th>效率</th>
  </tr>
  <tr>
    <td>自编码器</td>
    <td>特征降维</td>
    <td>人工为主</td>
    <td>自监督</td>
    <td>非端到端为主</td>
    <td>低</td>
    <td>高</td>
  </tr>
  <tr>
    <td>卷积神经网络</td>
    <td>局部特征</td>
    <td>人工/学习</td>
    <td>无监督/自监督/有监督</td>
    <td>非端到端/端到端</td>
    <td>中</td>
    <td>中</td>
  </tr>
  <tr>
    <td>Transformer</td>
    <td>全局特征</td>
    <td>人工/学习</td>
    <td>无监督/自监督/有监督</td>
    <td>非端到端/端到端</td>
    <td>高</td>
    <td>低</td>
  </tr>
</table>
<div align=center>表3 生成式深度学习图像融合方法对比</div>
<table align=center>
  <tr>
    <th>判别式融合</th>
    <th>特征表示</th>
    <th>融合策略</th>
    <th>监督方式</th>
    <th>训练方式</th>
    <th>复杂度</th>
    <th>效率</th>
  </tr>
  <tr>
    <td>自编码器</td>
    <td>特征降维</td>
    <td>人工为主</td>
    <td>自监督</td>
    <td>非端到端为主</td>
    <td>低</td>
    <td>高</td>
  </tr>
  <tr>
    <td>卷积神经网络</td>
    <td>局部特征</td>
    <td>人工/学习</td>
    <td>无监督/自监督/有监督</td>
    <td>非端到端/端到端</td>
    <td>中</td>
    <td>中</td>
  </tr>
  <tr>
    <td>Transformer</td>
    <td>全局特征</td>
    <td>人工/学习</td>
    <td>无监督/自监督/有监督</td>
    <td>非端到端/端到端</td>
    <td>高</td>
    <td>低</td>
  </tr>
</table>

## 基于深度学习的图像融合实验对比

实验部分选择12种代表性图像融合算法从定性、融合质量以及运行效率三方面全面评估算法的性能。其中基于自编码器子类，选择[DenseFuse](https://ieeexplore.ieee.org/document/8580578)和[DIDFuse](https://www.ijcai.org/proceedings/2020/135)分别对应单编码器和多编码器的融合方法，融合策略均选择在原文中表现优异的加法融合；基于卷积神经网络子类，选择[U2Fusion]()、[STDFusionNet]()、[SeAFusion]()和[DeFusion]()分别对应无监督、手工标注、任务驱动和自监督的方法；基于Transformer子类，选择[SwinFusion]()和[SwinFuse]()分别对应ViT和HVT的方法；基于生成对抗网络的子类，选择[FusionGAN]()和[GANFM]()分别对应单判别器和多判别器的方法；基于扩散模型的子类，选择[Diff-IF]()和[DDFM]()分别对应以融合图像为先验和以模态图像为先验的方法。需要说明的是，由于基于变分自编码器的图像融合方法较少且未公开预训练模型，因此对比实验中未包含该类别的算法。

用于验证方法的测试集选择[VTUAV]()、[Fireman]()、[BOOSS]()数据集，对应目标监测、灾情预警和专业巡检三类场景，图像尺寸分别为640×360,640×512和512×512。实验中从这些数据集中各随机选取50对图像进行定量评估。所有的源图像在空间上严格对齐。Fireman数据集中伪彩色红外图像，先经过YCbCr转换保留Y通道，这一操作不影响红外图像中的强度信息。所有可见光图像在融合前转换到YCbCr颜色空间，保留Y通道红外图像进行融合，融合后通过逆变换转为RGB融合结果。

## 结语
尽管基于深度学习的可见光和红外图像融合方法取得了一系列成果，但在低空遥感实际应用中仍需要突破在各种非理想条件下的技术难点：1）未精确配准的图像融合；2）干扰环境下的图像融合；3）运动模糊下的图像融合。

基于深度学习的可见光和红外图像融合具有巨大的应用潜力，以下未来研究方向将进一步推动图像融合方法的探索，并加速其在低空遥感场景中的落地应用：1）高效实时的图像融合；2）统一全面的客观评价；3）任务协同的图像融合。
## 代码使用方法
见[metric calculation](https://github.com/sunbinuestc/VIF-metrics-analysis/tree/fec9d88fe85de35246e82eb0d4dc95c535b9d0f4/code/Python/metric%20calculation)

## 引用信息
孙彬, 游航, 李文博, 刘祥瑞, 马佳义. 双光载荷图像融合及其在低空遥感中的应用[J/OL]. 航空学报, 1-23[2025-04-09]. http://kns.cnki.net/kcms/detail/11.1929.V.20241227.1548.002.html.

Bin Sun, Hang You, Wenbo Li, Xiangrui Liu, Jiayi Ma. Dual-band payload image fusion and its application in low-altitude remote sensing[J/OL]. Acta Aeronautica et Astronautica Sinica, 1-23[2025-04-09]. http://kns.cnki.net/kcms/detail/11.1929.V.20241227.1548.002.html.

在项目中，我们引用了一些网络中开源的客观指标计算代码，在此感谢提供这些代码的开发者！
